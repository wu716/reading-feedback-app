# 🚀 数据可视化功能 - 快速启动指南

## 一键启动

### 步骤1：启动应用
```bash
# 在项目根目录执行
python start_app.py
```

或使用其他启动脚本：
- Windows: `start_final.cmd` 或 `启动应用.bat`
- 其他: `start_final.py`

### 步骤2：访问仪表盘
打开浏览器访问：
```
http://localhost:8000/static/dashboard.html
```

或从主页点击「📊 数据可视化」入口卡片

## 📊 功能预览

### 四大视图
1. **📈 综合视图** - 整体数据概览和对比
2. **🎯 触发型视图** - 情境型行为分析
3. **🔄 习惯型视图** - 习惯养成进度
4. **⚖️ 对比分析** - 多维度雷达对比

### 核心图表（共12个）
#### 触发型（4个）
- 成功率趋势折线图
- 场景分类饼图
- TOP5场景柱状图
- 活动热力日历

#### 习惯型（4个）
- 坚持日历热力图
- 习惯进度柱状图
- 周完成趋势图
- 完成率仪表盘

#### 对比分析（3个）
- 多维雷达图
- 成功率对比柱图
- 活动量饼图

#### 综合（3个）
- 整体趋势对比
- 触发型分布
- 习惯型进度

### AI智能洞察
每个视图都包含自动生成的：
- ✅ 数据分析
- ⚠️ 问题预警
- 💡 优化建议
- 📈 趋势识别

## 🎯 使用技巧

### 1. 时间范围选择
点击顶部时间按钮快速切换：
- 7天：短期观察
- 30天：月度分析（**推荐**）
- 90天：季度回顾
- 180天：半年总结
- 365天：年度报告

### 2. 视图切换
- 点击Tab快速切换视图
- 数据自动刷新
- 保持时间范围

### 3. 图表交互
- **鼠标悬停**：查看详细数据
- **点击图例**：显示/隐藏数据系列
- **窗口缩放**：图表自适应

### 4. AI洞察
滚动到页面底部查看：
- 成功/失败模式
- 改进建议
- 异常提醒

## 🔧 后端API

### 新增接口
```
GET /api/dashboard/stats/trigger-detailed?days=30
GET /api/dashboard/stats/habit-detailed?days=30
GET /api/dashboard/stats/comprehensive?days=30
```

### 返回数据示例
```json
{
  "period_days": 30,
  "trigger": {
    "overall_success_rate": 75.5,
    "total_attempts": 120,
    "success_count": 90,
    "trend_data": [...],
    "category_distribution": [...],
    "top_scenarios": [...],
    "daily_heatmap": [...]
  },
  "habit": {
    "overall_completion_rate": 82.3,
    "current_streak": 7,
    "longest_streak": 15,
    "completed_days": 247,
    "calendar_heatmap": [...],
    "habit_progress": [...],
    "weekly_stats": [...]
  }
}
```

## 📱 移动端访问

### 响应式设计
- 自动适配手机/平板
- 触摸友好的交互
- 简化的移动视图

### 推荐浏览器
- Chrome (推荐)
- Firefox
- Safari
- Edge

## ⚡ 性能优化

### 已实施
- ✅ 数据缓存（5分钟）
- ✅ 异步加载
- ✅ 图表懒渲染
- ✅ 响应式重绘

### 最佳实践
- 首次加载可能需要1-2秒
- 建议至少7天数据
- 定期清理浏览器缓存

## 🐛 故障排除

### 常见问题

#### 1. 图表不显示
**原因**：数据不足或加载失败
**解决**：
- 检查是否有实践记录
- 查看浏览器控制台错误
- 刷新页面重试

#### 2. 数据不更新
**原因**：缓存未刷新
**解决**：
- 等待5分钟自动刷新
- 或重启应用清除缓存

#### 3. AI洞察为空
**原因**：数据量不足
**解决**：
- 至少需要3条记录
- 继续记录行为数据

#### 4. 页面空白
**原因**：未登录或认证失效
**解决**：
- 返回主页重新登录
- 检查token是否过期

### 检查清单
```bash
# 1. 确认应用运行
curl http://localhost:8000/

# 2. 测试API接口
curl http://localhost:8000/api/dashboard/stats/comprehensive?days=30 \
  -H "Authorization: Bearer YOUR_TOKEN"

# 3. 查看后端日志
# 检查是否有报错信息
```

## 📊 数据需求

### 最少数据量
- **触发型**：至少3次尝试记录
- **习惯型**：至少3天坚持记录
- **对比分析**：两种类型各3条

### 推荐数据量
- **7天**：日常观察
- **30天**：月度分析（⭐推荐）
- **90天+**：趋势识别

## 🎨 视觉指南

### 颜色方案
- **触发型**：蓝紫色 (#667eea)
- **习惯型**：橙色系 (#ff9800)
- **成功**：绿色 (#28a745)
- **警告**：黄色 (#ffc107)
- **错误**：红色 (#dc3545)

### 图表类型映射
| 数据特征 | 推荐图表 |
|---------|---------|
| 趋势变化 | 折线图/面积图 |
| 分类占比 | 饼图/环形图 |
| 数值对比 | 柱状图 |
| 多维对比 | 雷达图 |
| 时间密度 | 热力图 |
| 进度展示 | 仪表盘 |

## 🚀 进阶使用

### 1. 导出数据（规划中）
未来将支持：
- PDF报告导出
- 图表PNG下载
- Excel数据导出

### 2. 自定义配置（规划中）
- 自定义时间范围
- 选择显示图表
- 设置阈值提醒

### 3. 数据对比（规划中）
- 不同时间段对比
- 同类行为对比
- 目标达成对比

## 📞 技术支持

### 获取帮助
1. 查看 `数据可视化功能说明.md` 详细文档
2. 检查浏览器开发者工具（F12）
3. 查看后端日志文件

### 反馈问题
记录以下信息：
- 浏览器版本
- 操作步骤
- 错误截图
- 控制台日志

---

**享受数据可视化带来的洞察！** 📊✨

如有问题，请参考详细文档或查看代码注释。

